<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .line_tooltip,
      .bar_tooltip {
        position: absolute;
        display: none;
        min-width: 80px;
        height: auto;
        background: none repeat scroll;
        border: 1px solid #6f257f;
        padding: 14px;
        text-align: center;
        background-color: white;
        z-index: 1;
      }
    </style>
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </head>
  <body></body>
  <script>
    function makeData(x, num) {
      let arr = [];
      let objNum = num + 1;
      for (let i = 1; i < objNum; i++) {
        let obj = {
          [x]: Math.floor(Math.random() * 11 + 1),
        };
        arr.push(obj);
      }
      return arr;
    }

    const data = makeData("x", 10);

    const margin = { top: 80, right: 50, bottom: 100, left: 70 },
      width = 630 - margin.left - margin.right,
      height = 528 - margin.top - margin.bottom;

    const svg = d3
      .select("body")
      .append("svg")
      .attr("id", "bar_chart")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .style("background-color", "rgba(255,255,255,1)");

    const g = svg
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    const xScale = d3
      .scaleLinear()
      .domain([
        0,
        d3.max(data, function (d) {
          return d.x;
        }),
      ])
      .range([0, width]);

    const yScale = d3
      .scaleBand()
      .domain(d3.range(0, data.length))
      .range([height, 0])
      .padding(0.4);

    const xAxis = g
      .append("g")
      .attr("id", "x_axis")
      .attr("transform", `translate(0, ${height})`)
      .call(d3.axisBottom(xScale));

    const yAxis = g.append("g").attr("id", "y_axis").call(d3.axisLeft(yScale));

    const title = g
      .append("text")
      .attr("x", 13 * 20)
      .attr("y", 0 - margin.top / 2)
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .attr("fill", "rgb(103, 103, 103)")
      .text("Weather");

    const xTitle = g
      .append("text")
      .attr("x", 13 * 20)
      .attr("y", height + margin.top - 30)
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .attr("fill", "rgb(103, 103, 103)")
      .text("Weeks");

    const yTitle = g
      .append("text")
      .attr("y", -40)
      .attr("x", -9 * 20)
      .style("transform", "rotate(270deg)")
      .attr("font-size", "0.9em")
      .attr("text-anchor", "middle")
      .attr("fill", "rgb(103, 103, 103)")
      .text("Temperature");

    function make_x_gridlines() {
      return d3.axisBottom(xScale).ticks();
    }

    const xGrid = g.append("g").attr("class", "grid");

    xGrid
      .attr("id", "x_grid")
      .attr("class", "grid")
      .attr("transform", "translate(0," + height + ")")
      .call(make_x_gridlines().tickSize(-height).tickFormat(""));

    function make_y_gridlines() {
      return d3.axisLeft(yScale).ticks();
    }

    const yGrid = g.append("g").attr("class", "grid");

    yGrid
      .attr("id", "y_grid")
      .attr("class", "grid")
      .call(make_y_gridlines().tickSize(-width).tickFormat(""));

    const bars = g.selectAll("rect").data(data);

    bars.exit().remove();

    bars
      .enter()
      .append("rect")
      .attr("class", "bars")
      .attr("height", yScale.bandwidth())
      .attr("width", function (d, i) {
        return xScale(d.x);
      })
      .attr("y", function (d, i) {
        return yScale(i);
      })

      .attr("stroke", "rgba(42, 42, 42, 0.187)")
      .attr("fill", "rgba(249, 203, 156, 0.46)");

    d3.select("#x_axis > path").attr("display", "none");

    d3.selectAll(".grid > g > line").attr("stroke", "rgba(0, 0, 0, 0.108)");
    d3.selectAll(".tick > text").style("fill", "rgb(130, 130, 130)");
    d3.select("#x_axis > path").style("stroke", "rgb(211, 211, 211)");
    d3.select("#y_axis > path").style("stroke", "rgb(211, 211, 211)");
    d3.selectAll("#x_axis >.tick>line").style("display", "none");
    d3.selectAll("#y_axis >.tick>line").style("display", "none");
    d3.select("#x_grid > g:nth-child(2) > line").attr(
      "stroke",
      "rgba(0,0,0,0)"
    );
    d3.select("#y_grid > g:nth-child(1) > line").attr(
      "stroke",
      "rgba(0,0,0,0)"
    );
    d3.select("#x_grid > path").attr("stroke", "rgba(0,0,0,0)");
    d3.select("#y_grid > path").attr("stroke", "rgba(0,0,0,0)");
  </script>
</html>
