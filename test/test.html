<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
      .bar_tooltip,
      .line_tooltip,
      .pie_tooltip {
        position: absolute;
        display: none;
        min-width: 80px;
        height: auto;
        background: none repeat scroll;
        border: 1px solid #afafaf;
        padding: 14px;
        text-align: center;
        background-color: white;
        z-index: 1;
      }

      .hovered:hover {
        opacity: 0.7;
      }
      #pie_div {
        display: inline-block;
        background-color: grey;
      }
      font {
        fill: white;
      }
    </style>
  </head>
  <body>
    <div id="pie_div"></div>
  </body>
  <script>
    function createData() {
      function makeDateArray() {
        let arr = [];
        let startDate = new Date("2020-01-02"); //YYYY-MM-DD
        let endDate = new Date("2020-01-22"); //YYYY-MM-DD

        while (startDate <= endDate) {
          arr.push(new Date(startDate));
          startDate.setDate(startDate.getDate() + 1);
        }
        return arr;
      }
      let dates = makeDateArray();
      let i = 1;
      let data = dates.map(function (x) {
        i += 30;
        return {
          date: x,
          num1: Math.floor(Math.random() * 101 + i++),
          num2: Math.floor(Math.random() * 101 + i++),
          num3: Math.floor(Math.random() * 101 + i++),
        };
      });
      return data;
    }

    const data = createData();

    const margin = { top: 80, right: 50, bottom: 80, left: 80 },
      width = 600 - margin.left - margin.right,
      height = 480 - margin.top - margin.bottom;

    const svg = d3
      .select("body")
      .append("svg")
      .attr("id", "line_chart")
      .attr("width", `${width + margin.left + margin.right}`)
      .attr("height", `${height + margin.top + margin.bottom}`)
      .style("background-color", "rgba(0, 0, 0, 0.55)");

    const g = svg
      .append("g")
      .attr("transform", `translate(${margin.left},${margin.top})`);

    const title = g
      .append("text")
      .attr("x", 13 * 20)
      .attr("y", 0 - margin.top / 2)
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .attr("fill", "rgb(255, 255, 255)")
      .text("Total Reported Cases");

    const xTitle = g
      .append("text")
      .attr("x", 13 * 20)
      .attr("y", height + margin.top - 30)
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .attr("fill", "rgb(255, 255, 255)")
      .text("Days");

    const yTitle = g
      .append("text")
      .attr("y", -40)
      .attr("x", -9 * 20)
      .style("transform", "rotate(270deg)")
      .attr("font-size", "0.9em")
      .attr("text-anchor", "middle")
      .attr("fill", "rgb(255, 255, 255)")
      .text("Cases");

    const xScale = d3
      .scaleTime()
      .domain(
        d3.extent(data, function (d) {
          return d.date;
        })
      )
      .range([0, width]);

    const yScale = d3
      .scaleLinear()
      .domain([
        0,
        d3.max(data, function (d) {
          return d.num1;
        }),
      ])
      .range([height, 0]);

    const xAxis = g
      .append("g")
      .attr("id", "x_axis")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(xScale));

    const yAxis = g.append("g").attr("id", "y_axis").call(d3.axisLeft(yScale));

    function make_y_gridlines() {
      return d3.axisLeft(yScale).ticks();
    }

    const yGrid = g
      .append("g")
      .attr("class", "grid")
      .attr("id", "y_grid")
      .call(make_y_gridlines().tickSize(-width).tickFormat(""));

    const line1 = d3
      .line()
      .x(function (d) {
        return xScale(d.date);
      })
      .y(function (d) {
        return yScale(d.num1);
      });

    g.append("path")
      .data([data])
      .attr("class", "line")
      .attr("d", line1)
      .attr("stroke", "rgb(250, 250, 250)")
      .attr("stroke-width", `${1 * 0.5}px`)
      .attr("fill", "none");

    const circles1 = g.selectAll(".circles1").data(data);
    circles1.exit().remove();
    circles1
      .enter()
      .append("circle")
      .attr("class", "circles1")
      .attr("display", "")
      .attr("r", 6 * 0.5)
      .attr("cx", function (d, i) {
        return xScale(d.date);
      })
      .attr("cy", function (d, i) {
        return yScale(d.num1);
      })
      .attr("fill", "rgba(255, 255, 255, 0)")
      .attr("stroke", "rgba(255, 255, 255, 1)")
      .attr("stroke-width", "1px");

    d3.select("#y_axis > path").attr("display", "none");

    d3.selectAll("#x_axis >.tick>line").style("display", "none");
    d3.selectAll("#y_axis >.tick>line").style("display", "none");
    d3.select("#x_grid > path").attr("stroke", "rgba(0,0,0,0)");
    d3.select("#y_grid > path").attr("stroke", "rgba(0,0,0,0)");
    d3.select("#y_grid > g:nth-child(2) > line").remove();
    d3.selectAll(".tick > text").style("fill", "rgb(238, 238, 238)");
    d3.selectAll(".grid > g > line").attr(
      "stroke",
      "rgba(255, 255, 255, 0.337)"
    );
    d3.select("#x_axis > path").style("stroke", "rgb(255, 255, 255)");
    d3.select("#y_axis > path").style("stroke", "rgb(211, 211, 211)");
  </script>
</html>
